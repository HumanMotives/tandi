<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Mōme — Releases</title>

  <style>
  :root{
    --max-width: 980px;
    --gap: 16px;
    --muted: #6d6d6d;
    --accent: #000;             /* black accents */
    --bg: #fff;
    --card-bg: #fff;
    --radius: 12px;
    --shadow: 0 8px 24px rgba(0,0,0,0.06);
    --platinum: #E0E1DE;
    --lion: #A88D6F;
    font-family: "Helvetica Neue", Arial, sans-serif;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    background:var(--bg);
    color:#111;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    padding:24px 16px;
  }
  .container{max-width:var(--max-width);margin:0 auto}
  .site-header{margin-bottom:18px}
  h1{font-size:28px;margin:0 0 6px}
  .lead{color:var(--muted);margin:0 0 18px;font-size:15px}

  /* masonry */
  .masonry{column-width: 240px; column-gap: var(--gap)}
  /* base card */
  .card{
    display:inline-block;
    width:100%;
    margin:0 0 var(--gap);
    background:var(--card-bg);
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    overflow:hidden;
    vertical-align:top;
  }
  /* HERO card (first tile) */
  .card--hero{
    display:inline-flex;
    width:100%;
    margin:0 0 var(--gap);
    background: linear-gradient(180deg, var(--platinum) 0%, #fff 100%);
    border-radius:var(--radius);
    overflow:hidden;
    align-items:center;
    justify-content:center;
    text-align:center;
    padding:28px;
    min-height:300px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.08);
  }
  .hero-inner{max-width:520px}
  .hero-brand{
    font-size:84px;
    line-height:0.9;
    letter-spacing:-0.02em;
    margin-bottom:8px;
    font-weight:700;
    color:var(--accent);
    font-family: "Helvetica Neue", Arial, sans-serif;
  }
  .hero-tag{
    font-size:16px;
    color:var(--muted);
    margin-bottom:14px;
  }
  .hero-actions{display:flex;gap:12px;justify-content:center;flex-wrap:wrap}
  .hero-actions .btn{padding:10px 14px}

  /* normal card contents */
  .card img{width:100%;display:block;height:auto;object-fit:cover}
  .card-body{padding:12px}
  .card-title{font-weight:700;margin:0 0 6px;font-size:15px}
  .card-meta{color:var(--muted);font-size:13px;margin-bottom:10px}
  .card-actions{display:flex;gap:8px;justify-content:space-between;align-items:center}
  .btn{background:#000;color:#fff;border:0;padding:8px 12px;border-radius:8px;font-weight:600;cursor:pointer}
  .btn-ghost{background:transparent;color:var(--muted);border:1px solid #eee;padding:6px 10px}

  .site-footer{margin-top:32px;color:var(--muted);font-size:13px;text-align:center;padding-bottom:40px}

  /* modal */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:none;align-items:center;justify-content:center;padding:20px;z-index:2200}
  .modal[aria-hidden="false"]{display:flex}
  .modal-inner{max-width:760px;width:100%;background:#fff;border-radius:12px;padding:18px;box-shadow:0 20px 80px rgba(0,0,0,0.3);display:flex;gap:14px;position:relative}
  .modal-close{position:absolute;right:18px;top:18px;background:transparent;border:0;font-size:22px;color:#111;cursor:pointer}
  .modal-cover{width:220px;height:220px;object-fit:cover;border-radius:8px;flex-shrink:0}
  .modal-meta{flex:1}
  .muted{color:var(--muted)}
  .small{font-size:13px}

  @media (max-width:720px){
    .hero-brand{font-size:48px}
    .hero-inner{padding:6px}
    .masonry{column-width:160px}
    .card--hero{min-height:220px;padding:18px}
  }
  </style>
</head>
<body>
  <main class="container">
    <section class="site-header">
      <h1 style="font-weight:700;margin-bottom:6px">Mōme</h1>
      <p class="lead">Tiny sound releases from where you are</p>
    </section>

    <section id="releasesGrid" class="masonry">
      <!-- Hero tile will be injected by JS as the first card -->
    </section>

    <footer class="site-footer container"><small>Demo grid — click a card to open a release. Mōme is focused on short field recordings.</small></footer>
  </main>

  <!-- Modal player -->
  <div id="playerModal" class="modal" aria-hidden="true">
    <div class="modal-inner" role="dialog" aria-modal="true">
      <button class="modal-close" id="modalClose">×</button>
      <img id="modalCover" src="" alt="Cover" class="modal-cover">
      <div class="modal-meta">
        <h2 id="modalTitle">Title</h2>
        <p id="modalLocation" class="muted">Location</p>
        <p id="modalDate" class="muted small">Date</p>

        <audio id="modalAudio" controls preload="auto" style="width:100%;margin-top:10px"></audio>

        <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
          <button id="btnLike" class="btn">♡ Like <span id="likeCount" style="margin-left:8px">0</span></button>
          <button id="btnShare" class="btn" style="background:#444">Share</button>
        </div>

        <p id="modalDesc" class="muted small" style="margin-top:12px"></p>
      </div>
    </div>
  </div>

  <script>
  /* ===== demo dataset (same as before) ===== */
  const DUMMY = [
    { id:'r1', title:'Morning Pool', location:'Casteren, NL', date:'2025-01-10T09:12:00Z', cover:'https://images.unsplash.com/photo-1503435824048-a799a3a84f9e?auto=format&fit=crop&w=800&q=60', audio:'https://interactive-examples.mdn.mozilla.net/media/cc0-audio/t-rex-roar.mp3', description:'Short ambient capture of sunlight and kids playing.', likes:12 },
    { id:'r2', title:'Dune Walk', location:'California, USA', date:'2025-01-05T18:30:00Z', cover:'https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=800&q=60', audio:'https://interactive-examples.mdn.mozilla.net/media/cc0-audio/t-rex-roar.mp3', description:'Wind and footsteps on sand.', likes:23 },
    { id:'r3', title:'Night Tram', location:'Amsterdam, NL', date:'2025-01-20T21:15:00Z', cover:'https://images.unsplash.com/photo-1482192596544-9eb780fc7f66?auto=format&fit=crop&w=800&q=60', audio:'https://interactive-examples.mdn.mozilla.net/media/cc0-audio/t-rex-roar.mp3', description:'Low hum and passing announcements.', likes:3 },
    { id:'r4', title:'Forest Shimmer', location:'Unknown', date:'2024-12-29T07:00:00Z', cover:'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?auto=format&fit=crop&w=800&q=60', audio:'https://interactive-examples.mdn.mozilla.net/media/cc0-audio/t-rex-roar.mp3', description:'Leaves, birds and distant water.', likes:9 }
  ];

  /* ===== helpers ===== */
  function fmtDate(iso){
    const d = new Date(iso);
    return d.toLocaleDateString(undefined,{ year:'numeric', month:'short', day:'numeric'});
  }
  function escapeHtml(s){ return String(s).replace(/[&<>"']/g, t=> ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[t])); }

  const grid = document.getElementById('releasesGrid');

  /* Render hero tile first (logo + tagline + quick actions) */
  function renderHeroTile() {
    const hero = document.createElement('article');
    hero.className = 'card card--hero';
    hero.innerHTML = `
      <div class="hero-inner">
        <div class="hero-brand">Mōme</div>
        <div class="hero-tag">tiny sound releases from where you are</div>
        <div class="hero-actions">
          <button class="btn" id="btnCreate">Create</button>
          <button class="btn btn-ghost" id="btnAbout">About</button>
          <button class="btn btn-ghost" id="btnExplore">Explore</button>
        </div>
      </div>
    `;
    grid.appendChild(hero);

    // Example wiring for the hero buttons
    document.addEventListener('click', (e)=>{
      const t = e.target;
      if (t.id === 'btnCreate') alert('Start capture flow (hook into your app)');
      if (t.id === 'btnAbout') alert('Mōme — tiny sound releases. Capture, craft, publish.');
      if (t.id === 'btnExplore') alert('Explore releases (scroll the grid)');
    });
  }

  /* render the rest of the cards */
  function renderGrid(list){
    // hero first
    renderHeroTile();

    list.forEach(r=>{
      const el = document.createElement('article');
      el.className = 'card';
      el.innerHTML = `
        <img loading="lazy" src="${r.cover}" alt="${escapeHtml(r.title)}">
        <div class="card-body">
          <div class="card-title">${escapeHtml(r.title)}</div>
          <div class="card-meta">${escapeHtml(r.location)} • ${fmtDate(r.date)}</div>
          <div class="card-actions">
            <button class="btn btn-open" data-id="${r.id}">Luister</button>
            <div><button class="btn-ghost btn-like" data-id="${r.id}">♡ <span class="count">${r.likes}</span></button></div>
          </div>
        </div>
      `;
      grid.appendChild(el);
    });
  }

  /* modal */
  const modal = document.getElementById('playerModal');
  const modalClose = document.getElementById('modalClose');
  const modalTitle = document.getElementById('modalTitle');
  const modalLocation = document.getElementById('modalLocation');
  const modalDate = document.getElementById('modalDate');
  const modalCover = document.getElementById('modalCover');
  const modalAudio = document.getElementById('modalAudio');
  const modalDesc = document.getElementById('modalDesc');
  const btnLike = document.getElementById('btnLike');
  const btnShare = document.getElementById('btnShare');
  const likeCountSpan = document.getElementById('likeCount');

  let currentRecord = null;

  function openById(id){
    const r = DUMMY.find(x=>x.id===id);
    if(!r) return;
    currentRecord = r;
    modal.setAttribute('aria-hidden','false');
    modalTitle.textContent = r.title;
    modalLocation.textContent = r.location;
    modalDate.textContent = fmtDate(r.date);
    modalCover.src = r.cover;
    modalDesc.textContent = r.description || '';
    modalAudio.src = r.audio;
    likeCountSpan.textContent = getLikes(r.id);
    modalAudio.currentTime = 0;
    modalAudio.play().catch(()=>{/* ignore autoplay errors */});
    document.body.style.overflow = 'hidden';
  }

  function closeModal(){
    modalAudio.pause();
    modalAudio.src = '';
    modal.setAttribute('aria-hidden','true');
    currentRecord = null;
    document.body.style.overflow = '';
  }

  modalClose.addEventListener('click', closeModal);
  modal.addEventListener('click', (e)=>{
    if(e.target === modal) closeModal();
  });

  /* likes using localStorage */
  function getLikes(id){
    const saved = localStorage.getItem('likes_' + id);
    if(saved !== null) return Number(saved);
    const r = DUMMY.find(x=>x.id===id);
    return r ? (r.likes || 0) : 0;
  }
  function setLikes(id, n){
    localStorage.setItem('likes_' + id, String(n));
  }

  /* event delegation */
  document.addEventListener('click',(ev)=>{
    const openBtn = ev.target.closest('.btn-open');
    if(openBtn){
      const id = openBtn.dataset.id;
      openById(id);
      return;
    }
    const likeBtn = ev.target.closest('.btn-like');
    if(likeBtn){
      const id = likeBtn.dataset.id;
      const current = getLikes(id);
      const next = current + 1;
      setLikes(id, next);
      likeBtn.querySelector('.count').textContent = next;
      // Optional: send API call to server / Supabase to persist
      return;
    }
  });

  btnLike.addEventListener('click', ()=>{
    if(!currentRecord) return;
    const id = currentRecord.id;
    const current = getLikes(id);
    const next = current + 1;
    setLikes(id, next);
    likeCountSpan.textContent = next;
    const btn = document.querySelector(`.btn-like[data-id="${id}"]`);
    if(btn) btn.querySelector('.count').textContent = next;
  });

  btnShare.addEventListener('click', async ()=>{
    if(!currentRecord) return;
    const url = location.href.split('#')[0] + '#release=' + currentRecord.id;
    if(navigator.share){
      try{
        await navigator.share({ title: currentRecord.title, text: `Luister: ${currentRecord.title}`, url });
      }catch(e){ /* cancelled */ }
    } else {
      try{
        await navigator.clipboard.writeText(url);
        alert('Link gekopieerd naar klembord');
      }catch(e){
        prompt('Kopieer deze link', url);
      }
    }
  });

  // keyboard close
  document.addEventListener('keydown',(e)=>{
    if(e.key === 'Escape' && modal.getAttribute('aria-hidden') === 'false') closeModal();
  });

  // initial render
  renderGrid(DUMMY);
  </script>
</body>
</html>
